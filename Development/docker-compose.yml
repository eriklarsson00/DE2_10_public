version: '3.8'

services:
  ray-head:
    build: .
    container_name: ray-head
    command: ray start --head --port=6379
    ports:
      - "6379:6379"
    environment:
      - RAY_HEAD_SERVICE_HOST=ray-head
      - RAY_HEAD_SERVICE_PORT=6379
    volumes:
      - .:/app
      - ./results:/app/results

  ray-worker:
    build: .
    container_name: ray-worker
    command: ray start --address=ray-head:6379
    environment:
      - RAY_HEAD_SERVICE_HOST=ray-head
      - RAY_HEAD_SERVICE_PORT=6379
    depends_on:
      - ray-head
    volumes:
      - .:/app
